<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script language="javascript" type="text/javascript" src="../js/p5/empty-example/libraries/p5.js"></script>
    <script language="javascript" type="text/javascript" src="../js/p5/empty-example/libraries/p5.dom.js"></script>
    <script language="javascript" type="text/javascript" src="../js/p5/empty-example/libraries/p5.sound.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet">

    <script language="javascript" type="text/javascript" src="../js/memory/grid.js"></script>
    <script language="javascript" type="text/javascript" src="../js/memory/gameControls.js"></script>
    <script language="javascript" type="text/javascript" src="../js/memory/history.js"></script>
    <script language="javascript" type="text/javascript" src="../js/memory/successStory.js"></script>
    <script language="javascript" type="text/javascript" src="../js/memory/resultPanel.js"></script>

    <!-- this line removes any default padding and style. you might only need one of these values set. -->
    <link rel="stylesheet" type="text/css" href="../assets/css/memory.css">

</head>
<body>
<div id="mainDiv">
</div>
<script>

    var grid;

    var gameControls;

    var gameHistory;

    var successStory;

    var doubleClickLock;

    const createMemoryCanvas = function () {
        const ratio = 0.75;
        const width = window.innerWidth < window.innerHeight ? window.innerWidth * ratio : window.innerHeight * ratio;
        const canvas = createCanvas(width, width);
        canvas.parent("#mainDiv");
        return canvas;
    };

    function setup() {
        canvas = createMemoryCanvas();
        noLoop();
        gameHistory = new GameHistory();
        successStory = new SuccessStory(2);
        grid = new Grid(3, 3, 2, ["#ff0000", "#00ff00", "#0000ff"], gameHistory, successStory);
        gameControls = new GameControls(grid, gameHistory, successStory);
        gameControls.init();

        gameControls.animate();

        canvas.mouseReleased(function () {
            if(!doubleClickLock) {
                doubleClickLock = true;
                if (!gameControls.animationOn) {
                    grid.mouseRelease();
                }
                setTimeout(function() {doubleClickLock = false}, 400);
            }
        });
    }

    function draw() {
        background(0);
        grid.changeColor();
        grid.display();
    }


</script>


</body>
</html>